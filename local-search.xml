<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Python - if__name__ == &#39;__main__&#39;</title>
    <link href="/2022/12/01/Python-if-name-main/"/>
    <url>/2022/12/01/Python-if-name-main/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux - FTP Connection - ECONNREFUSED</title>
    <link href="/2022/11/29/Linux-ftp-econnection-refused/"/>
    <url>/2022/11/29/Linux-ftp-econnection-refused/</url>
    
    <content type="html"><![CDATA[<h4 id="Failed-to-connect-the-sever-through-FileZilla"><a href="#Failed-to-connect-the-sever-through-FileZilla" class="headerlink" title="Failed to connect the sever through FileZilla"></a>Failed to connect the sever through FileZilla</h4><ul><li>The error information:</li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ECONNREFUSED</span> - 连接被服务器拒绝<br></code></pre></td></tr></table></figure><ul><li>Follow 小明同学YYDS’s solution</li></ul><p><a href="https://blog.csdn.net/maoyuanming0806/article/details/78539655">https://blog.csdn.net/maoyuanming0806/article/details/78539655</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Error Collection</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux - Create and Delete User + Change Permission</title>
    <link href="/2022/11/29/Linux-manage-user/"/>
    <url>/2022/11/29/Linux-manage-user/</url>
    
    <content type="html"><![CDATA[<p>As a root&#x2F;admin user, manage other user account and accessing permision.</p><h4 id="Create-a-new-user-account"><a href="#Create-a-new-user-account" class="headerlink" title="Create a new user account"></a>Create a new user account</h4><ul><li>Add a new user called <code>test</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo adduser <span class="hljs-built_in">test</span></span><br></code></pre></td></tr></table></figure><ul><li><p>Type and retype password of the new user</p></li><li><p>Force the new user to change her password after first logon (expire the current one)</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo passwd -e <span class="hljs-built_in">test</span></span><br></code></pre></td></tr></table></figure><h4 id="Delete-an-existing-user-account"><a href="#Delete-an-existing-user-account" class="headerlink" title="Delete an existing user account"></a>Delete an existing user account</h4><ul><li>Use the <code>userdel</code> command as follows:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo userdel <span class="hljs-built_in">test</span></span><br></code></pre></td></tr></table></figure><ul><li>To remove home directory and mail spool too, enter:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo userdel -r <span class="hljs-built_in">test</span></span><br></code></pre></td></tr></table></figure><p><a href="https://www.cyberciti.biz/faq/create-a-user-account-on-ubuntu-linux/">https://www.cyberciti.biz/faq/create-a-user-account-on-ubuntu-linux/</a></p><h4 id="Create-Working-Directory-for-New-User-in-x2F-mnt"><a href="#Create-Working-Directory-for-New-User-in-x2F-mnt" class="headerlink" title="Create Working Directory for New User (in &#x2F;mnt)"></a>Create Working Directory for New User (in &#x2F;mnt)</h4><p>Remark: There are two harddisks mounted to the department sever. We need divide the users into different disks and balance the space usage. Take <code>/mnt/disk1</code> as example,</p><ul><li>Create new directory, named by user</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">mkdir</span> /mnt/disk1/test</span><br></code></pre></td></tr></table></figure><ul><li>Change the ownership of the directory</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">chown</span> -R [username] [user directory]</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">chown</span> -R <span class="hljs-built_in">test</span> /mnt/disk1/test</span><br></code></pre></td></tr></table></figure><h4 id="Change-Permission"><a href="#Change-Permission" class="headerlink" title="Change Permission"></a>Change Permission</h4><ul><li>Only the owner of the directory can read&#x2F;write&#x2F;excute it</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">chmod</span> -R 700 /mnt/disk1/test</span><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/u013197629/article/details/73608613">https://blog.csdn.net/u013197629/article/details/73608613</a></p><p><a href="https://stackoverflow.com/questions/3740152/how-do-i-change-permissions-for-a-folder-and-its-subfolders-files">https://stackoverflow.com/questions/3740152/how-do-i-change-permissions-for-a-folder-and-its-subfolders-files</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Server Management</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux - Mount New Hard Drive</title>
    <link href="/2022/11/15/Linux-mount-new-harddrive/"/>
    <url>/2022/11/15/Linux-mount-new-harddrive/</url>
    
    <content type="html"><![CDATA[<h4 id="GUI-install-ubuntu-desktop"><a href="#GUI-install-ubuntu-desktop" class="headerlink" title="GUI: install ubuntu-desktop"></a>GUI: install ubuntu-desktop</h4><p>working as “root” user</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> sudo su<br><span class="hljs-variable">$</span> sudo apt update &amp;&amp; apt upgrade<br><span class="hljs-variable">$</span> sudo apt install ubuntu<span class="hljs-literal">-desktop</span><br><span class="hljs-variable">$</span> sudo apt install slim<br><span class="hljs-variable">$</span> sudo service slim <span class="hljs-built_in">start</span><br></code></pre></td></tr></table></figure><p><a href="https://www.makeuseof.com/install-desktop-environment-gui-ubuntu-server/https://phoenixnap.com/kb/how-to-install-a-gui-on-ubuntu">https://www.makeuseof.com/install-desktop-environment-gui-ubuntu-server/https://phoenixnap.com/kb/how-to-install-a-gui-on-ubuntu</a></p><h4 id="Partition-tool-install-Gparted"><a href="#Partition-tool-install-Gparted" class="headerlink" title="Partition tool: install Gparted"></a>Partition tool: install Gparted</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">$ sudo apt <span class="hljs-keyword">install</span> gparted<br></code></pre></td></tr></table></figure><p><a href="https://linuxways.net/centos/how-to-install-gparted-on-ubuntu-20-04/">https://linuxways.net/centos/how-to-install-gparted-on-ubuntu-20-04/</a></p><h4 id="Access-remote-desktop-by-Windows-remote-desktop"><a href="#Access-remote-desktop-by-Windows-remote-desktop" class="headerlink" title="Access remote desktop: by Windows remote desktop"></a>Access remote desktop: by Windows remote desktop</h4><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pf">$ sudo apt install xrdp<br>$ sudo systemctl enable --now xrdp<br>$ sudo ufw allow <span class="hljs-keyword">from</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> <span class="hljs-number">3389</span> <span class="hljs-keyword">proto</span> tcp<br></code></pre></td></tr></table></figure><p><a href="https://linuxconfig.org/ubuntu-20-04-remote-desktop-access-from-windows-10">https://linuxconfig.org/ubuntu-20-04-remote-desktop-access-from-windows-10</a></p><h4 id="Click-Gparted-and-create-partition-table-new-partition"><a href="#Click-Gparted-and-create-partition-table-new-partition" class="headerlink" title="Click Gparted and create partition table + new partition"></a>Click Gparted and create partition table + new partition</h4><p><a href="https://linuxways.net/centos/how-to-install-gparted-on-ubuntu-20-04/">https://linuxways.net/centos/how-to-install-gparted-on-ubuntu-20-04/</a></p><h4 id="Mount-new-partitions"><a href="#Mount-new-partitions" class="headerlink" title="Mount new partitions"></a>Mount new partitions</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo fdisk -l</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /home</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">mkdir</span> /disk1</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo vim /etc/fstab</span><br>/dev/sda1   /home/disk1    ext4       defaults       0       0<br><span class="hljs-meta prompt_">$ </span><span class="language-bash">mount /home/disk1</span><br></code></pre></td></tr></table></figure><p><a href="https://askubuntu.com/questions/125257/how-do-i-add-an-additional-hard-drive">https://askubuntu.com/questions/125257/how-do-i-add-an-additional-hard-drive</a></p><h3 id="After-partition，REMOVE-THE-DISPLAY-DEPENDENCIES-REMOTE-DESKTOP-AND-DESKTOP"><a href="#After-partition，REMOVE-THE-DISPLAY-DEPENDENCIES-REMOTE-DESKTOP-AND-DESKTOP" class="headerlink" title="After partition，REMOVE THE DISPLAY DEPENDENCIES, REMOTE DESKTOP AND DESKTOP"></a>After partition，REMOVE THE DISPLAY DEPENDENCIES, REMOTE DESKTOP AND DESKTOP</h3>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Server Management</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python - Build Your Own Package</title>
    <link href="/2022/08/23/Python-Build%20own%20package/"/>
    <url>/2022/08/23/Python-Build%20own%20package/</url>
    
    <content type="html"><![CDATA[<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><p>A module is a file containing Python definitions and statements. The file name is the module name with the suffix <code>.py</code> appended.  <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Modules](https://docs.python.org/3/tutorial/modules.html)">[1]</span></a></sup></p><p>Within a module, the module’s name (as a string) is available as the value of the global variable <code>__name__</code>. </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-built_in">print</span>(np.__name__)<br><br>&gt;&gt; numpy<br></code></pre></td></tr></table></figure><h2 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h2><p>A module can contain multiple objects, such as classes, functions, etc. A package can contain one or more relevant modules. Physically, a package is actually a <strong>folder containing one or more module files</strong>. <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Tutorials Teacher - Python Package](https://www.tutorialsteacher.com/python/python-package)">[2]</span></a></sup></p><p>Python package can have sub-packages and modules. A directory must contain a file named <code>__init__.py</code> in order for Python to consider it as a package. This file can be left empty but we generally place the initialization code for that package in this file.</p><p>Packages allow hierarchical structure of the module namespace. One example package as below,</p><p><img src="/img/module_structure.png" alt="image"><br>Here we have four directories, <code>my_model</code>, <code>training</code>, <code>submission</code> and <code>metrics</code>, among which, the last three ones are the subpackage of the first one, <code>my_model</code>. And within all packages and subpackages, the files ending with <code>.py</code> are modules. For each package, we need <code>__inint__.py</code> to indicate the entry of it. <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Python编程基础07：标准库和第三方库](https://controlnet.space/2022/05/06/tutorial/python-fund/py-prog-fund-07/)">[3]</span></a></sup></p><hr><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.python.org/3/tutorial/modules.html">Modules</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.tutorialsteacher.com/python/python-package">Tutorials Teacher - Python Package</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://controlnet.space/2022/05/06/tutorial/python-fund/py-prog-fund-07/">Python编程基础07：标准库和第三方库</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python - Method</title>
    <link href="/2022/08/22/Python-Method/"/>
    <url>/2022/08/22/Python-Method/</url>
    
    <content type="html"><![CDATA[<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><h4 id="What-is-method"><a href="#What-is-method" class="headerlink" title="What is method?"></a>What is <em>method</em>?</h4><p>A Python method is a label that you can call on an object; it is a piece of code to execute on that object. <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Python Method – Classes, Objects and Functions in Python](https://data-flair.training/blogs/python-method/)">[1]</span></a></sup></p><h4 id="The-difference-between-method-and-function"><a href="#The-difference-between-method-and-function" class="headerlink" title="The difference between method and function"></a>The difference between <em>method</em> and <em>function</em></h4><p>A <em>method</em> in python is similar to a function, except it is associated with object&#x2F;classes. There are two major differences. <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Difference between Method and Function in Python](https://www.tutorialspoint.com/difference-between-method-and-function-in-python)">[2]</span></a></sup></p><ul><li><p>The method is implicitly used for an object for which it is called.</p></li><li><p>The method is accessible to data that is contained within the class.</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pet</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;I am a Cat&quot;</span>)<br>cat = Pet()<br>cat.my_method()<br><br>&gt;&gt; I am a Cat<br></code></pre></td></tr></table></figure><p>If we want object accept arguments, like</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cat = Pet(<span class="hljs-string">&#x27;Cat&#x27;</span>)<br></code></pre></td></tr></table></figure><p>We need <code>__init__</code> method. Otherwise, the program will report error as “TypeError: object() takes no arguments.” </p><p>The <code>__init__</code> method lets us assign a value for the “self.name” variable in our class. Here the <code>__init__</code> is one way to implement magic method in python.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pet</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        self.name = name<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;I am a <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span>)<br>cat = Pet(<span class="hljs-string">&quot;Cat&quot;</span>)<br>cat.my_method()<br><br>&gt;&gt; I am a Cat<br></code></pre></td></tr></table></figure><p>##Class<br>A <code>Class</code> is like an object constructor, or a “blueprint” for creating objects. <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Python Classes and Objects](https://www.w3schools.com/python/python_classes.asp)">[3]</span></a></sup></p><p>It has all the properties mentioned in the plan, and the corresponding <code>object</code> behaves as the plan. </p><p>We can take a the class ‘Student’ as example. It contains properties like name, gender, and grade.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, gender, score</span>):<br>        self.name = name<br>        self.gender = gender<br>        self.score = score<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">grade</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> self.score&gt;=<span class="hljs-number">60</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;self.name&#125;</span> passes the final exam.&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;self.name&#125;</span> fails the final exam.&#x27;</span>)<br><br>student1 = Student(name = <span class="hljs-string">&#x27;Arwen&#x27;</span>, gender = <span class="hljs-string">&#x27;female&#x27;</span>, score = <span class="hljs-number">80</span>)<br></code></pre></td></tr></table></figure><p>##Object<br>A Python <code>object</code> is an instance of a <code>class</code>. It can have properties and behavior accordingly. We just created the class “Student” and an object “student1”. So we can access the method and the attribute of “student1”:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">student1.grade()<br></code></pre></td></tr></table></figure><blockquote><p>Arwen passes the final exam.</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">student1.gender<br><br>&gt;&gt; <span class="hljs-string">&#x27;female&#x27;</span><br></code></pre></td></tr></table></figure><p>We can use other magic method in python, such as <code>__dict__</code>. <sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[__dict__ attribute and vars() function in python.](https://medium.com/analytics-vidhya/dict-attribute-and-vars-function-in-python-42d82dbaba73)">[4]</span></a></sup></p><p>For class “Student”, <code>__dict__</code> returns all the attributes in the class.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">Student.__dict__<br><br>&gt;&gt; mappingproxy(&#123;<span class="hljs-string">&#x27;__module__&#x27;</span>: <span class="hljs-string">&#x27;__main__&#x27;</span>,<br>&gt;&gt;               <span class="hljs-string">&#x27;__init__&#x27;</span>: &lt;function __main__.Student.__init__(self, name, gender, score)&gt;,<br>&gt;&gt;              <span class="hljs-string">&#x27;grade&#x27;</span>: &lt;function __main__.Student.grade(self)&gt;,<br>&gt;&gt;               <span class="hljs-string">&#x27;__dict__&#x27;</span>: &lt;attribute <span class="hljs-string">&#x27;__dict__&#x27;</span> of <span class="hljs-string">&#x27;Student&#x27;</span> objects&gt;,<br>&gt;&gt;              <span class="hljs-string">&#x27;__weakref__&#x27;</span>: &lt;attribute <span class="hljs-string">&#x27;__weakref__&#x27;</span> of <span class="hljs-string">&#x27;Student&#x27;</span> objects&gt;,<br>&gt;&gt;               <span class="hljs-string">&#x27;__doc__&#x27;</span>: <span class="hljs-literal">None</span>&#125;)<br></code></pre></td></tr></table></figure><p>For object “student1”, <code>__dict__</code> returns all the attributes of the object. The method in the class will not be included.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">student1.__<span class="hljs-built_in">dict</span><br><br>&gt;&gt; &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;Arwen&#x27;</span>, <span class="hljs-string">&#x27;gender&#x27;</span>: <span class="hljs-string">&#x27;female&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">80</span>&#125;<br></code></pre></td></tr></table></figure><hr><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://data-flair.training/blogs/python-method/">Python Method – Classes, Objects and Functions in Python</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.tutorialspoint.com/difference-between-method-and-function-in-python">Difference between Method and Function in Python</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.w3schools.com/python/python_classes.asp">Python Classes and Objects</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://medium.com/analytics-vidhya/dict-attribute-and-vars-function-in-python-42d82dbaba73"><strong>dict</strong> attribute and vars() function in python.</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://zetcode.com/python/magicmethods/">Python magic methods</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python-Geocoding-with-Amap-API</title>
    <link href="/2020/12/10/Python-Geocoding-with-Amap-API/"/>
    <url>/2020/12/10/Python-Geocoding-with-Amap-API/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>(CAUTION) Unexpected High Bill Amount When Using googlemaps in Python</title>
    <link href="/2020/12/08/Python-How-to-burn-13-thousand-with-one-line/"/>
    <url>/2020/12/08/Python-How-to-burn-13-thousand-with-one-line/</url>
    
    <content type="html"><![CDATA[<blockquote><p>I am really grateful that I have the warmest support from my advisor and friends during this hard time.<br>最下方有本文的“马保国全文背诵版”，感谢阿Q精神，差点丢了1w3，但是没失去快乐。(You can find the Chinese version of my experience for fun.)</p></blockquote><p>To be frank, I think the subtitle of this blog is supposed to be “How to burn 13 thousands with one line and get your money back”. </p><p>Last month, I had to deal with a large list of addresses and geocode them to latitude and longitude. To complete all transformation in hand is almost impossible. So it is natural that using map API to solve this issue. There is no doubt Google Maps performs the best on processing address in English. And I found it offers an official python toolkit <code>googlemaps</code>, which can saves lots of time.</p><p>Before turning on two APIs required by <code>googlemaps</code>, “Places API” and “Geocoding API”, I also checked the pricing plan of Google Maps Platform. Google Maps Platform uses a pay-as-you-go pricing model. Users can request <a href="https://developers.google.com/maps/billing/gmp-billing?hl=en_US#basic-data">basic data</a> for free and the price of <a href="https://developers.google.com/maps/billing/gmp-billing?hl=en_US#geocoding">geocoding</a> is not quite expensive (no more than 5 USD per 1000 requests).</p><p>After reading several tutorials about Google Maps Platform, I finally chose to use the python function suggested by <a href="https://blog.csdn.net/dongyouyuan/article/details/76618442">DHogan</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Tutorial for GoolgeMaps API in Python](https://blog.csdn.net/dongyouyuan/article/details/76618442)">[2]</span></a></sup>, and my code can be found in <a href="https://arwenzhou.github.io/2020/11/20/Python-Geocoding/">this blog</a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Python-Geocoding](https://arwenzhou.github.io/2020/11/20/Python-Geocoding/)">[1]</span></a></sup>. However, geocoding the address by <code>text_search</code> function in <code>googlemaps</code> is fairly expensive (<a href="https://developers.google.com/maps/billing/gmp-billing?hl=en_US#text-search">Price of <code>text_search</code></a>), especially the prerequisite “Places API” costs tenfold as “Geocoding API” does.</p><p>In that “black sunday afternoon”, I started requesting loops with pleasure and had a cheerful dinner. Everything went well until I received the payment notification from my credit card bank. Although I shut the program down as soon as possible, these few lines of codes had cost my 13 thousand bucks…</p><p><img src="/img/201208/fee-total.png" alt="Total Cost"></p><p>So, </p><ul><li>PLEASE CHECK THE PRICE OF EACH LINE IN YOUR CODE WHEN USING <strong>PAID APIs</strong>.</li><li>SET <strong>REQUEST LIMIT</strong> FOR YOUR APIs AVOIDING FATAL ATTACKS.</li><li>SET CONSUMPTION LIMIT FOR EVERY <strong>PAY-AS-YOU-GO ACCOUNT</strong>.</li></ul><p>Fortunately, the experience of another GMP user gave me hope.<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[[Be careful] Google OAuth + Google Cloud API may not behave as expected](https://1c7.me/google-oauth-and-google-cloud-api-may-cost-you-money-instead-of-end-user/)">[3]</span></a></sup> (Sincere thanks to <a href="https://1c7.me/">CHENG ZHENG</a>) I contacted GMP team immediately by both phone call and email. Here is the flow of GMP support for my issue.</p><p><img src="/img/201208/GMP-Support-Diagram.svg" alt="Flow of GMP Support"></p><p>GMP provides 3 ways for users to get support from platform. </p><ul><li>Chat: Haven’t tried. But chat support in billing section is paid service.</li><li>Phone call: GMP team will create a new case for you and contact you through email too. (Later than directly submitting the case through email.) </li><li>Email: Reponsive and supportive!</li></ul><p><img src="/img/201208/google-maps-support.png" alt="GMP Support Page"></p><p>I reported my case on support page and chose to communicate with GMP Team by “email”. I can not find the case description any more. But, for reference, I emphasized three key points, which were also proposed in feedback survey: </p><ol><li><p>The prices of functions in official toolkit <code>googlemaps</code> are not clear and transparent enough. </p></li><li><p>The cost of prerequisite ‘Places API’ is unexpected, since user only takes the geocoding services.</p></li><li><p>The consumption nofication is delayed, and user can hardly stop the program or request in time.<br><img src="/img/201208/fee1100.jpg" alt="Payment Notification"></p></li></ol><p>However, I have to say that GMP team took actions promptly and gave me genial helps. I list all emails between GMP and me below.</p><p>From billing team:<br><img src="/img/201208/email1.png" alt="Email1"><br>My reply to billing team<br><img src="/img/201208/email2.png" alt="Email2"><br>From tech team (including the tutorial for <strong>restricting API key</strong> and <strong>setting daily request limits</strong>):<br><img src="/img/201208/email3.png" alt="Email3"><br>My answers to tech team’s questions:<br><img src="/img/201208/email4.png" alt="Email4"><br>From tech team (accidental usage spike is validated and the tutorial for <strong>shutting down project</strong> ):<br><img src="/img/201208/email5.png" alt="Email5"><br>My reply:<br><img src="/img/201208/email6.png" alt="Email6"><br>My question about shutting my project down:<br><img src="/img/201208/email7.png" alt="Email7"><br>Answers from tech team:<br><img src="/img/201208/email8.png" alt="Email8"><br>From billing team:<br><img src="/img/201208/email9.png" alt="Email9"><br>My reply:<br><img src="/img/201208/email10.png" alt="Email10"><br>From billing team (transferring my adjustment request to internal team):<br><strong>THIS ADJUSTMENT IS ONE TIME COURTESY</strong><br><img src="/img/201208/email11.png" alt="Email11"><br>My reply:<br><img src="/img/201208/email12.png" alt="Email12"><br>The adjustment request is approved:<br><img src="/img/201208/email13.png" alt="Email13"><br>Some further questions:<br><img src="/img/201208/email14.png" alt="Email14"> </p><p>GMP COMPLETES THE ADJUSTMENT IN DEC 3!!!<br>I noticed that good news several days later.<br><img src="/img/201208/adjustment.png" alt="Adjustment"> </p><p>At last, I really appreciate the assistance from GMP team. We all should know that the adjustment is only one-time-courtesy and the future charge will be counted as valid.</p><p><strong>PLEASE BE CAUTIOUS WHEN YOU ENABLE EVERY PAID APIs!</strong></p><hr><p>Thanks to ‘one of the best’ standup comedian, Master MA Baoguo, I got over from losing 13 thousands HKD, and encouraged myself to deal with the mess.</p><p>Here is the <em>MA Baoguo</em> version of this story in Chinese, just have fun!</p><blockquote><p>朋友们好啊我是BUG代码烧钱门掌门人。</p></blockquote><blockquote><p>刚才有个朋友问我周老师发生甚么事了，我说怎么回事？给我发了几张截图。我一看，噢！原来是昨天，有两个API，都是Google的，一个Places API，一个Geocoding API。</p></blockquote><blockquote><p>塔们说，诶…有一个说，“如果你要英文地址转码，转换成经纬度，周老师你能不能用用我这个toolkit？诶…可以搜索出老师你要的信息。”</p></blockquote><blockquote><p>我说可以，但是我说你这个文档，不好用，他不服气。我说小朋友你能不能让我一行代码直接完成转换，他做不到。他说“你这也没用”，我说我这个有用。</p></blockquote><blockquote><p>这是面向CV工程师（ctrl+c&#x2F;v），传统功夫是讲CV的，四两拨千斤，体重200多斤的英国大力士都写不动我这一行，啊…他说要和我试试，我说可以。</p></blockquote><blockquote><p>诶…我一说，他“啪”就站起来了。很快啊！然后上来就是一个账户注册，一个信用卡关联，一个端口默认开启。</p></blockquote><blockquote><p>我全部防出去了啊。防出去以后自然是传统功夫以点到为止，把包调了出来，只做了几次调试。我笑一下，准备收手。</p></blockquote><blockquote><p>他也承认我是正常调用。他承认我按照文档调试的，啊！我吃饭的时间打算不调用了，他突然能循环跑起来，啊，我大E了啊，没有闪。</p></blockquote><blockquote><p>诶…他的默认开的那个信用卡。信用卡扣了一千，但没关系啊。他也说啊，他截图也说了，我流眼泪了，捂着眼，我说婷婷，我给程序停了。结果一晚上以后，又欠了一万。</p></blockquote><blockquote><p>我说小伙子你不讲武德你不懂，他忙说， “周老师对不起，我不懂规矩，啊，我是…” 他说他是乱打的。</p></blockquote><blockquote><p>他可不是乱打的啊，注册连卡开端口训练有素，后来他说他有三四页不同的Price文档，Basic Data免费和toolkit又不是一回事。啊，看来是有备而来。</p></blockquote><blockquote><p>这两个年轻人，不讲武德，</p></blockquote><blockquote><p>来，跑！</p></blockquote><blockquote><p>来，偷袭！</p></blockquote><blockquote><p>我2*岁的老同志。这好吗？这不好。</p></blockquote><blockquote><p>我劝这位年轻人，耗子尾汁，好好反思。以后不要再犯这样的聪明，小聪明，啊。Coding Dog要以和为贵，要讲武德，不要搞窝里斗。</p></blockquote><blockquote><p>谢谢朋友们！</p></blockquote><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://arwenzhou.github.io/2020/11/20/Python-Geocoding/">Python-Geocoding</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/dongyouyuan/article/details/76618442">Tutorial for GoolgeMaps API in Python</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://1c7.me/google-oauth-and-google-cloud-api-may-cost-you-money-instead-of-end-user/">[Be careful] Google OAuth + Google Cloud API may not behave as expected</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python-Geocoding [WARNING!!]</title>
    <link href="/2020/11/20/Python-Geocoding/"/>
    <url>/2020/11/20/Python-Geocoding/</url>
    
    <content type="html"><![CDATA[<h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a><strong>Warning</strong></h3><blockquote><p>Please be cautious when you run the code below, especially when you turn on <code>Places API</code> and use <code>text_search</code> in <code>googlemaps</code>!!!</p></blockquote><blockquote><p>Although requesting <em>Basic Data</em> is free, it could be quite expensive when you <code>geocode</code> address information with <code>text_search</code>. (<a href="https://developers.google.com/maps/billing/gmp-billing?hl=en_US#text-search">Price of <code>text_search</code></a>)</p></blockquote><hr><p>To retreive latitude and longitude of specific address of Hong Kong, I subscribe <a href="https://console.cloud.google.com/google/maps-apis/credentials?project=testshopper">Google Maps Geocoding API</a> and install two packages <a href="http://github.com/slimkrazy/python-google-places">googleplaces</a> and <a href="https://github.com/googlemaps/google-maps-services-python">googlemaps</a>. The first one is  thrid-party tool and the second is official one.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs &#123;python&#125;">pip install python-google-places<br>pip install --upgrade https://github.com/slimkrazy/python-google-places/zipball/master  ## upgrade package and solve 2,500-request limit<br><br>pip install -U googlemaps<br></code></pre></td></tr></table></figure><p>Referring to blog of <a href="https://blog.csdn.net/dongyouyuan">DHogan</a> <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Tutorial for GoogleMaps API: including Geocoding API，Places API Web Service](https://blog.csdn.net/dongyouyuan/article/details/76618442)">[1]</span></a></sup>, geocoding code is listed below:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs &#123;python&#125;">from googleplaces import GooglePlaces<br>import googlemaps<br>import json  <br><br>class GoogleMaps(object):<br>    &quot;&quot;&quot;提供google maps服务&quot;&quot;&quot;<br><br>    def __init__(self):<br><br>        self._GOOGLE_MAPS_KEY = &quot;My API Key&quot;<br>        self._Google_Places = GooglePlaces(self._GOOGLE_MAPS_KEY)<br>        self._Google_Geocod = googlemaps.Client(key=self._GOOGLE_MAPS_KEY)<br><br>    def _text_search(self, query, language=None, location=None):<br>        &quot;&quot;&quot;<br>        根据搜索字符串,请求google API传回推荐的列表<br>        :param query: 搜索字符串<br>        :param language: 语言<br>        :param location: 地区筛选<br>        :return:<br>        &quot;&quot;&quot;<br>        # lat_lng = &#123;&quot;lat&quot;: &quot;22.5745761&quot;, &quot;lng&quot;: &quot;113.9393772&quot;&#125;<br>        # 经纬度附近搜索<br>        # text_query_result = self.self._Google_Places.text_search(query=&#x27;Gong Yuan&#x27;, lat_lng=lat_lng)<br>        # location 为人可认识的名称<br>        # text_query_result = self.self._Google_Places.text_search(query=&#x27;Tang Lang Shan&#x27;, location=&#x27;shenzhen&#x27;)<br>        # 指定语言搜索<br>        text_query_result = self._Google_Places.text_search(query=query, language=language, location=location)<br>        return text_query_result.places<br><br></code></pre></td></tr></table></figure><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/dongyouyuan/article/details/76618442">Tutorial for GoogleMaps API: including Geocoding API，Places API Web Service</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Crawling</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Error - Cannot install `rJava`</title>
    <link href="/2020/11/17/Error-Cannot-install-rJava/"/>
    <url>/2020/11/17/Error-Cannot-install-rJava/</url>
    
    <content type="html"><![CDATA[<p>Today I recreate and setup a new instance on Aliyun. But installation error occurs again, when I install <code>rJava</code> package in R 3.6.3 on Ubuntu 16.04.</p><p>Here is the error information:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><code class="hljs &#123;R&#125;"> Installing package into ‘/usr/local/lib/R/site-library’<br>(as ‘lib’ is unspecified)<br>trying URL &#x27;https://cloud.r-project.org/src/contrib/rJava_0.9-<br>Content type &#x27;application/x-gzip&#x27; length 664898 bytes (649 KB)<br>==================================================<br>downloaded 649 KB<br><br>* installing *source* package ‘rJava’ ...<br>** package ‘rJava’ successfully unpacked and MD5 sums checked<br>** using staged installation<br>checking for gcc... gcc -std=gnu99<br>checking whether the C compiler works... yes<br>checking for C compiler default output file name... a.out<br>checking for suffix of executables...<br>checking whether we are cross compiling... no<br>checking for suffix of object files... o<br>checking whether we are using the GNU C compiler... yes<br>checking whether gcc -std=gnu99 accepts -g... yes<br>checking for gcc -std=gnu99 option to accept ISO C89... none needed<br>checking how to run the C preprocessor... gcc -std=gnu99 -E<br>checking for grep that handles long lines and -e... /bin/grep<br>checking for egrep... /bin/grep -E<br>checking for ANSI C header files... yes<br>checking for sys/wait.h that is POSIX.1 compatible... yes<br>checking for sys/types.h... yes<br>checking for sys/stat.h... yes<br>checking for stdlib.h... yes<br>checking for string.h... yes<br>checking for memory.h... yes<br>checking for strings.h... yes<br>checking for inttypes.h... yes<br>checking for stdint.h... yes<br>checking for unistd.h... yes<br>checking for string.h... (cached) yes<br>checking sys/time.h usability... yes<br>checking sys/time.h presence... yes<br>checking for sys/time.h... yes<br>checking for unistd.h... (cached) yes<br>checking for an ANSI C-conforming const... yes<br>checking whether time.h and sys/time.h may both be included... yes<br>configure: checking whether gcc -std=gnu99 supports static inline...<br>yes<br>checking whether setjmp.h is POSIX.1 compatible... yes<br>checking whether sigsetjmp is declared... yes<br>checking whether siglongjmp is declared... yes<br>checking Java support in R... present:<br>interpreter : &#x27;/usr/lib/jvm/default-java/jre/bin/java&#x27;<br>archiver    : &#x27;/usr/lib/jvm/default-java/bin/jar&#x27;<br>compiler    : &#x27;/usr/lib/jvm/default-java/bin/javac&#x27;<br>header prep.: &#x27;/usr/lib/jvm/default-java/bin/javah&#x27;<br>cpp flags   : &#x27;-I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux&#x27;<br>java libs   : &#x27;-L/usr/lib/jvm/default-java/jre/lib/amd64/server -ljvm&#x27;<br>checking whether Java run-time works... yes<br>checking whether -Xrs is supported... yes<br>checking whether -Xrs will be used... yes<br>checking whether JVM will be loaded dynamically... no<br>checking whether JNI programs can be compiled... yes<br>checking whether JNI programs run... yes<br>checking JNI data types... ok<br>checking whether JRI should be compiled (autodetect)... yes<br>checking whether debugging output should be enabled... no<br>checking whether memory profiling is desired... no<br>checking whether threads support is requested... no<br>checking whether callbacks support is requested... no<br>checking whether JNI cache support is requested... no<br>checking whether headless init is enabled... no<br>checking whether JRI is requested... yes<br>configure: creating ./config.status<br>config.status: creating src/Makevars<br>config.status: creating R/zzz.R<br>config.status: creating src/config.h<br>=== configuring in jri (/tmp/RtmpQeRtyF/R.INSTALL60f3d5ed5db/rJava/jri)<br>configure: running /bin/bash ./configure --disable-option-checking &#x27;--prefix=/usr/local&#x27;  --cache-file=/dev/null --srcdir=.<br>checking build system type... x86_64-unknown-linux-gnu<br>checking host system type... x86_64-unknown-linux-gnu<br>checking for gcc... gcc -std=gnu99<br>checking whether the C compiler works... yes<br>checking for C compiler default output file name... a.out<br>checking for suffix of executables...<br>checking whether we are cross compiling... no<br>checking for suffix of object files... o<br>checking whether we are using the GNU C compiler... yes<br>checking whether gcc -std=gnu99 accepts -g... yes<br>checking for gcc -std=gnu99 option to accept ISO C89... none needed<br>checking how to run the C preprocessor... gcc -std=gnu99 -E<br>checking for grep that handles long lines and -e... /bin/grep<br>checking for egrep... /bin/grep -E<br>checking for ANSI C header files... yes<br>checking Java version... 1.8.0_275<br>checking Java compatibility version (integer)... 8<br>checking whether /usr/lib/jvm/default-java/bin/javah actually works... yes<br>checking for target flags...  -target 1.4 -source 1.4<br>checking whether Java interpreter works... checking whether JNI programs can be compiled... yes<br>checking whether JNI programs can be run... yes<br>checking JNI data types... ok<br>checking whether Rinterface.h exports R_CStackXXX variables... yes<br>checking whether Rinterface.h exports R_SignalHandlers... yes<br>configure: creating ./config.status<br>config.status: creating src/Makefile<br>config.status: creating Makefile<br>config.status: creating run<br>config.status: creating src/config.h<br>** libs<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c Rglue.c -o Rglue.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c arrayc.c -o arrayc.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c callJNI.c -o callJNI.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c callback.c -o callback.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c fields.c -o fields.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c jri_glue.c -o jri_glue.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c loader.c -o loader.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c otables.c -o otables.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c rJava.c -o rJava.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c registration.c -o registration.o<br>gcc -std=gnu99 -I&quot;/usr/share/R/include&quot; -DNDEBUG -I. -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux    -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c tools.c -o tools.o<br>gcc -std=gnu99 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o rJava.so Rglue.o arrayc.o callJNI.o callback.o fields.o init.o jri_glue.o loader.o otables.o rJava.o registration.o tools.o -L/usr/lib/jvm/default-java/jre/lib/amd64/server -ljvm -L/usr/lib/R/lib -lR<br>(cd ../jri &amp;&amp; make)<br>make[1]: Entering directory &#x27;/tmp/RtmpQeRtyF/R.INSTALL60f3d5ed5db/rJava/jri&#x27;<br>make -C src JRI.jar<br>make[2]: Entering directory &#x27;/tmp/RtmpQeRtyF/R.INSTALL60f3d5ed5db/rJava/jri/src&#x27;<br>/usr/lib/jvm/default-java/bin/javac -target 1.4 -source 1.4 -d . ../RConsoleOutputStream.java ../RFactor.java ../REXP.java ../Rengine.java ../Mutex.java ../package-info.java ../RMainLoopCallbacks.java ../RVector.java ../RBool.java ../RList.java<br>warning: [options] bootstrap class path not set in conjunction with -source 1.4<br>warning: [options] source value 1.4 is obsolete and will be removed in a future release<br>warning: [options] target value 1.4 is obsolete and will be removed in a future release<br>warning: [options] To suppress warnings about obsolete options, use -Xlint:-options.<br>4 warnings<br>if [ -n &quot;/usr/lib/jvm/default-java/bin/javah&quot; ]; then /usr/lib/jvm/default-java/bin/javah -d . -classpath . org.rosuda.JRI.Rengine; fi<br>gcc -std=gnu99 -c -o Rengine.o Rengine.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux -I/usr/share/R/include -I/usr/share/R/include<br>gcc -std=gnu99 -c -o jri.o jri.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux -I/usr/share/R/include -I/usr/share/R/include<br>gcc -std=gnu99 -c -o Rcallbacks.o Rcallbacks.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux -I/usr/share/R/include -I/usr/share/R/include<br>gcc -std=gnu99 -c -o Rinit.o Rinit.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/share/R/include -I/usr/share/R/include<br>gcc -std=gnu99 -c -o globals.o globals.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux<br>gcc -std=gnu99 -c -o rjava.o rjava.c -g -Iinclude  -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux  -fpic -I/usr/lib/jvm/default-java/include -I/usr/lib/jvm/default-java/include/linux<br>rjava.c: In function ‘RJava_request_lock’:<br>rjava.c:22:3: warning: ignoring return value of ‘write’, declared with attribute warn_unused_result [-Wunused-result]<br>   write(ipcout, buf, sizeof(ptrlong));<br>   ^<br>rjava.c: In function ‘RJava_clear_lock’:<br>rjava.c:30:3: warning: ignoring return value of ‘write’, declared with attribute warn_unused_result [-Wunused-result]<br>   write(ipcout, buf, sizeof(ptrlong));<br>   ^<br>rjava.c: In function ‘RJava_request_callback’:<br>rjava.c:39:3: warning: ignoring return value of ‘write’, declared with attribute warn_unused_result [-Wunused-result]<br>   write(ipcout, buf, sizeof(ptrlong) * 3);<br>   ^<br>rjava.c: In function ‘RJava_init_ctrl’:<br>rjava.c:51:3: warning: ignoring return value of ‘write’, declared with attribute warn_unused_result [-Wunused-result]<br>   write(ipcout, buf, sizeof(ptrlong));<br>   ^<br>rjava.c:52:3: warning: ignoring return value of ‘read’, declared with attribute warn_unused_result [-Wunused-result]<br>   read(resin, buf, sizeof(ptrlong) * 2);<br>   ^<br>gcc -std=gnu99 -o libjri.so Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -shared -L/usr/lib/jvm/default-java/jre/lib/amd64/server -ljvm -Wl,--export-dynamic -fopenmp -Wl,-Bsymbolic-functions -Wl,-z,relro -L/usr/lib/R/lib -lR -lpcre2-8 -lpcre -llzma -lbz2 -lz -lrt -ldl -lm<br>/usr/bin/ld: cannot find -lpcre2-8<br>collect2: error: ld returned 1 exit status<br>Makefile.all:35: recipe for target &#x27;libjri.so&#x27; failed<br>make[2]: *** [libjri.so] Error 1<br>make[2]: Leaving directory &#x27;/tmp/RtmpQeRtyF/R.INSTALL60f3d5ed5db/rJava/jri/src&#x27;<br>Makefile.all:19: recipe for target &#x27;src/JRI.jar&#x27; failed<br>make[1]: *** [src/JRI.jar] Error 2<br>make[1]: Leaving directory &#x27;/tmp/RtmpQeRtyF/R.INSTALL60f3d5ed5db/rJava/jri&#x27;<br>Makevars:14: recipe for target &#x27;jri&#x27; failed<br>make: *** [jri] Error 2<br>ERROR: compilation failed for package ‘rJava’<br>* removing ‘/usr/local/lib/R/site-library/rJava’<br><br>The downloaded source packages are in<br>        ‘/tmp/RtmpRqbO8U/downloaded_packages’<br>Warning message:<br>In install.packages(&quot;rJava&quot;) :<br></code></pre></td></tr></table></figure><p>After searching <code>Makefile.all:35: recipe for target &#39;libjri.so&#39; failed</code>, several <code>lib</code> are added. <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Error Installing rJava | Makefile.all:38: recipe for target 'libjri.so' failed](https://stackoverflow.com/questions/40109139/error-installing-rjava-makefile-all38-recipe-for-target-libjri-so-failed)">[1]</span></a></sup></p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs q">sudo apt-<span class="hljs-built_in">get</span> install libbz2-<span class="hljs-built_in">dev</span> libpcre3-<span class="hljs-built_in">dev</span><br>sudo apt-<span class="hljs-built_in">get</span> install liblzma-<span class="hljs-built_in">dev</span> zlib1g-<span class="hljs-built_in">dev</span><br></code></pre></td></tr></table></figure><p>But the error still exists, and I check the returned error again and find one  line <code>/usr/bin/ld: cannot find -lpcre2-8</code>, which seems to remind us one <code>lib</code> can not be found.</p><p>Then I find a solution to resolve this error.<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Solved:/usr/bin/ld: cannot find -lxxx](https://www.jianshu.com/p/ccaf688f54c0)">[2]</span></a></sup> Although I have installed <code>libpcre2-8-0</code>, compiler still can not find it. So I relink <code>libpcre2-8.so</code> to where <code>.so</code> file really is.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ln</span> -s ./x86_64-linux-gnu/libpcre2-<span class="hljs-number">8</span>.so.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span> libpcre2-<span class="hljs-number">8</span>.so<br></code></pre></td></tr></table></figure><p>Then the problem is solved.</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://stackoverflow.com/questions/40109139/error-installing-rjava-makefile-all38-recipe-for-target-libjri-so-failed">Error Installing rJava | Makefile.all:38: recipe for target ‘libjri.so’ failed</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.jianshu.com/p/ccaf688f54c0">Solved:&#x2F;usr&#x2F;bin&#x2F;ld: cannot find -lxxx</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://zoomadmin.com/HowToInstall/UbuntuPackage/libpcre2-8-0">How To Install “libpcre2-8-0” Package on Ubuntu</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Error Collection</tag>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python - Get Data through API with Bearer Token (II) - Data Processing</title>
    <link href="/2020/11/12/Python-requests-API-2/"/>
    <url>/2020/11/12/Python-requests-API-2/</url>
    
    <content type="html"><![CDATA[<p>After printing out sample returned json data, I know the object is supposed to be converted to list of dictionary and then data frame.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Process data</span><br><span class="hljs-comment">#Type of object is &#x27;str&#x27;, so we need further processing</span><br><span class="hljs-built_in">type</span>(pro_res.text)<br><br><span class="hljs-comment">#Split json text into a list</span><br>dat = pro_res.text.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#Remove last element: &quot;&quot;</span><br>ind = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(dat)-<span class="hljs-number">1</span>))<br>dat = [dat[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ind]<br><span class="hljs-comment">#Convert list into data frame</span><br>df = pd.DataFrame([json.loads(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> dat])<br><br><span class="hljs-comment">#Two approaches to write output</span><br><span class="hljs-comment">##Approach 1: directly write csv</span><br><span class="hljs-comment">#df.to_csv(&#x27;ProductCategory.csv&#x27;, index = False,  encoding = &quot;utf-8&quot;, sep = &quot;\t&quot;)</span><br><br><span class="hljs-comment">##Approach 2: write to compressed file to save storage resources</span><br>compression_opts = <span class="hljs-built_in">dict</span>(method=<span class="hljs-string">&#x27;zip&#x27;</span>,archive_name=<span class="hljs-string">&#x27;ProductCategory.csv&#x27;</span>) <br>df.to_csv(<span class="hljs-string">&#x27;./API Data/ProductCategory/ProductCategory.zip&#x27;</span>, index = <span class="hljs-literal">False</span>, encoding = <span class="hljs-string">&quot;utf-8&quot;</span>, compression = compression_opts) <br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Crawling</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ImportError - Can’t determine version for bottleneck</title>
    <link href="/2020/11/12/ImportError-Can%E2%80%99t-determine-version-for-bottleneck/"/>
    <url>/2020/11/12/ImportError-Can%E2%80%99t-determine-version-for-bottleneck/</url>
    
    <content type="html"><![CDATA[<p>When I import <code>pandas</code>, I get error</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ImportError: Can’t determine version <span class="hljs-keyword">for</span> bottleneck<br></code></pre></td></tr></table></figure><p>After uninstalling and reinstalling related packags for many times, I manully remove all <code>bottleneck_version</code> files in <code>pckgs</code> directory and install it again.</p>]]></content>
    
    
    
    <tags>
      
      <tag>Error Collection</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python - Get Data through API with Bearer Token (I) - Data Collection</title>
    <link href="/2020/11/12/Python-requests-API_1/"/>
    <url>/2020/11/12/Python-requests-API_1/</url>
    
    <content type="html"><![CDATA[<p>As a Python beginner, I’m going to complete my first formal research task by Python, getting data from one open databank through API. But token is needed to be provided. So the blog is divided into two parts: retrieving token and calling API.</p><p>My work is mainly based on the <code>requests</code> module in Python. <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Python接口自动化之Token详解及应用](https://zhuanlan.zhihu.com/p/140391896)">[1]</span></a></sup> <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Quickstart for `requests`](https://requests.readthedocs.io/en/master/user/quickstart/)">[2]</span></a></sup></p><h2 id="Retrieve-Token"><a href="#Retrieve-Token" class="headerlink" title="Retrieve Token"></a>Retrieve Token</h2><p>We need <code>username</code> and <code>password</code> (<code>clinet_id</code> and <code>clinet_secret</code>) to retrieve temporary token.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment">#Url consists of three parts</span><br>Url = <span class="hljs-string">&#x27;domain&#x27;</span> + <span class="hljs-string">&#x27;path&#x27;</span> + <span class="hljs-string">&#x27;endpoint&#x27;</span> <br><br><span class="hljs-comment">#Construct data params</span><br>Data = &#123;<br>    <span class="hljs-string">&quot;grant_type&quot;</span> : <span class="hljs-string">&quot;password&quot;</span>,<br>    <span class="hljs-string">&quot;username&quot;</span> : <span class="hljs-string">&quot;myusername&quot;</span>,<br>    <span class="hljs-string">&quot;password&quot;</span> : <span class="hljs-string">&quot;mypassword&quot;</span><br>&#125;<br><br><span class="hljs-comment">#Specify headers</span><br>Headers = &#123;<br>    <span class="hljs-string">&quot;Content-Type&quot;</span> : <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span><br>&#125;<br><br><span class="hljs-comment">#Request token by POST</span><br>res = requests.post(Url, data=Data, headers = Headers)<br><br><span class="hljs-comment">#Print returned results (including token)</span><br><span class="hljs-built_in">print</span>(res.json())<br></code></pre></td></tr></table></figure><p>Here are the returned results:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#It contains token, token type and expiration time</span><br>&#123;<span class="hljs-string">&#x27;access_token&#x27;</span>: <span class="hljs-string">&#x27;xxxxxxx&#x27;</span>, <span class="hljs-string">&#x27;refresh_token&#x27;</span>: <span class="hljs-string">&#x27;yyyyyy&#x27;</span>, <span class="hljs-string">&#x27;token_type&#x27;</span>: <span class="hljs-string">&#x27;Bearer&#x27;</span>, <span class="hljs-string">&#x27;expires_in&#x27;</span>: <span class="hljs-number">86400</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Call-API"><a href="#Call-API" class="headerlink" title="Call API"></a>Call API</h2><p>Return status code to check whether your request works well. <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Status Code](https://stackoverflow.com/questions/59125946/unable-to-get-python-requests-with-api-token)">[3]</span></a></sup></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> requests,json<br><span class="hljs-comment">#Another url with different path and endpoint</span><br>Url = <span class="hljs-string">&#x27;domain&#x27;</span> + <span class="hljs-string">&#x27;path&#x27;</span> + <span class="hljs-string">&#x27;endpoint&#x27;</span><br><br><span class="hljs-comment">#Construct token</span><br>token = res.json()[<span class="hljs-string">&quot;access_token&quot;</span>] <br>token =<span class="hljs-string">&quot;Bearer&quot;</span> + <span class="hljs-string">&quot; &quot;</span> + token <span class="hljs-comment">#Remark: one blank &quot; &quot; between token type and token </span><br><span class="hljs-comment">#print(token)</span><br><br><span class="hljs-comment">#Specify headers, assigning token</span><br>Headers = &#123;<br>    <span class="hljs-string">&quot;Authorization&quot;</span> : token,<br>    <span class="hljs-string">&quot;Content-Type&quot;</span> : <span class="hljs-string">&quot;application/json&quot;</span><br>&#125;<br><br><span class="hljs-comment">#Specific json data params, depend on API</span><br>Data = &#123;<br>    <span class="hljs-string">&quot;sys_take&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <br>    <span class="hljs-string">&quot;sys_skip&quot;</span>: <span class="hljs-string">&quot;0&quot;</span><br>&#125;<br><br><span class="hljs-comment">#Call for API</span><br>pro_res = requests.post(Url, headers = Headers, json = Data)<br><span class="hljs-built_in">print</span>(pro_res.status_code)<br><span class="hljs-built_in">print</span>(pro_res.text)<br></code></pre></td></tr></table></figure><p>Here are returned results:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#If Error code 4xx or 5xx is returned, you need to check your code, especially headers. (json and data are two distinct params)</span><br><span class="hljs-number">200</span><br><span class="hljs-string">&#x27;text&#x27;</span><br></code></pre></td></tr></table></figure><p>It should be noticed that, <code>json()</code> is successfully called does not mean your request works well. <sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Return value of `requests`](https://blog.csdn.net/dta0502/article/details/83246807)">[4]</span></a></sup></p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/140391896">Python接口自动化之Token详解及应用</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://requests.readthedocs.io/en/master/user/quickstart/">Quickstart for <code>requests</code></a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://stackoverflow.com/questions/59125946/unable-to-get-python-requests-with-api-token">Status Code</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.csdn.net/dta0502/article/details/83246807">Return value of <code>requests</code></a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Crawling</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Exponetial Distribution and Poisson Distribution</title>
    <link href="/2020/11/09/Exponetial-Distribution-and-Poisson-Distribution/"/>
    <url>/2020/11/09/Exponetial-Distribution-and-Poisson-Distribution/</url>
    
    <content type="html"><![CDATA[<p>In paper of Fader and Hardie<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Fader, P. S., Hardie, B. G., & Lee, K. L. (2005). “Counting your customers” the easy way: An alternative to the Pareto/NBD model. Marketing science, 24(2), 275-284.">[1]</span></a></sup>, they review <em>Pareto&#x2F;NBD</em> framework for counting and forecasting number of customers in period $t$. and propose <em>BGD</em> framework. One of cores in two frameworks is adopting exponential distribution to model the distribution of purchase interval which is usually not intuitive as Poisson distribution. Hence I try to figure it out (which incents me starting this  blog ) and this note is mostly based on two blogs <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Poisson Distribution — Intuition, Examples, and Derivation](https://towardsdatascience.com/poisson-distribution-intuition-and-derivation-1059aeab90d)">[2]</span></a></sup> <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Exponential Distribution — Intuition, Derivation, and Applications](https://towardsdatascience.com/what-is-exponential-distribution-7bdd08590e2a)">[3]</span></a></sup>.</p><p>Firstly, I need to figure out wherer Poisson comes from.<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Relationship between Poisson Distribution and Binomial Distribution](https://medium.com/@andrew.chamberlain/deriving-the-poisson-distribution-from-the-binomial-distribution-840cc1668239)">[4]</span></a></sup> <sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Proof - Limiting form of Binomial distribution](https://www.le.ac.uk/users/dsgp1/COURSES/LEISTATS/poisson.pdf)">[5]</span></a></sup></p><p>For each individual(consumer), they have $p$ probability to purchase $x$ times in $n$ shopping trips, and her purchase decision follows a binomial distribution $Bin(n,p)$. Poisson distribution is the limiting form of Binomial distribution, $n \to \infty$. </p><p>Let’s have a look how could we prove that. Whilst $\lambda &#x3D; np$ is expected total purchase rate through $n$ trips, then we consider the $p.m.f$ of binomial distribution,</p><p>$$\begin{array}{c}<br>Bin(x ; n, p) &#x3D; \frac{n !}{(n-x) ! x !} p^{x}(1-p)^{n-x}<br>\end{array}$$</p><p>This can be rewritten as,<br>$$\begin{array}{c}<br>\frac{\lambda^{x}}{x !} \frac{n !}{(n-x) ! n^{x}}\left(1-\frac{\lambda}{n}\right)^{n}\left(1-\frac{\lambda}{n}\right)^{-x}<br>\end{array}$$</p><p>When $n\to\infty$,</p><p>$$\begin{align*}<br>&amp;\lim (n \rightarrow \infty) \frac{n !}{(n-x) ! n^{x}}\<br>&amp;&#x3D; \lim (n \rightarrow \infty)\left{\frac{n(n-1) \cdots(n-x+1)}{n^{x}}\right}\<br>&amp; &#x3D; 1 \<br>\end{align*}$$</p><p>$$\begin{align*}<br>\lim (n \rightarrow \infty)\left(1-\frac{\lambda}{n}\right)^{n} &amp; &#x3D; e^{-\lambda} \<br>\end{align*}$$</p><p>$$\begin{align*}<br>\lim(n \rightarrow \infty)\left(1-\frac{\lambda}{n}\right)^{-x}&amp; &#x3D; 1<br>\end{align*}$$</p><p>After substituting these part above, then the limiting form of binomial distribution is found,<br>$$\begin{align*}<br>\lim (n \rightarrow \infty) Bin(x ; n, p)&#x3D;\frac{\lambda^{x} e^{-\lambda}}{x !}<br>\end{align*}$$<br>a Poisson distribution $Pois(x;\lambda)$.</p><p>So we usually assume the number of transactions made by a customer follows a Poisson distrbution with trasaction rate $\lambda$.</p><p>In Fader and Hardie’s paper, they mention that, the assumption above is equivalent to assuming time interval between transactions is distributed exponentially.</p><p>Before we prove the relationship between Poisson and exponential distribution, transaction rate $\lambda$ could give us a glance of it. <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Exponential Distribution — Intuition, Derivation, and Applications](https://towardsdatascience.com/what-is-exponential-distribution-7bdd08590e2a)">[3]</span></a></sup></p><blockquote><p>However, when we model the time interval between transactions, we tend to speak in terms of time instead of rate, e.g., the number of years a computer can power on without failure is 10 years (instead of saying 0.1 failure&#x2F;year, which is a rate), a customer arrives every 10 minutes, major hurricanes come every 7 years, etc. When you see the terminology — “mean” of the exponential distribution — $\frac{1}{\lambda}$ is what it means.</p></blockquote><p>So decay rate $\frac{1}{\lambda}$, how long next transaction occurs, instead of $\lambda$, is reconsidered, although $\lambda$ in exponetial distribution is exactly same as that in Poisson process.</p><blockquote><p>If you think about it, the <strong>time interval until the trasaction occurs</strong> means <strong>during the waiting period, not a single transaction has happened</strong>.<br>This is, in other words, $Pois(x&#x3D;0)$.</p></blockquote><p>$$\begin{align*}<br>Pois(x &#x3D; k) &#x3D; \frac{\lambda^{k} e^{-\lambda}}{k!}<br>\end{align*}$$</p><p>When $k &#x3D; 0$,<br>$$\begin{align*}<br>Pois(x &#x3D; 0) &#x3D; \frac{\lambda^{0} e^{-\lambda}}{0!} &#x3D; e^{-\lambda}<br>\end{align*}$$</p><p>How about probability distribution of “nothing happens during the time duration $t$” ? (<strong>Poisson distribution assumes that transactions occurs independently to each other</strong>)</p><p>$$\begin{align*}<br>&amp;P(T&gt;t)\<br>&amp;&#x3D; P(Nothing\quad happens\quad during\quad t\quad time\quad units)\<br>&amp;&#x3D; P(X&#x3D;0\quad in\quad the\quad first\quad time\quad unit)\times P(X&#x3D;0\quad in\quad the\quad second\quad time\quad unit)\<br>&amp;\times\cdots \times P (X&#x3D;0\quad in\quad the\quad t-th\quad time\quad unit)\<br>&amp;&#x3D; e^{-\lambda} \times e^{-\lambda}\times \cdots \times e^{-\lambda}\<br>&amp;&#x3D; e^{-\lambda t}<br>\end{align*}$$</p><p>Then the probability of  transaction occurs before $t$ is<br>$$\begin{align*}<br>P(T \le t) &#x3D; 1 - P(T&gt;t) &#x3D; 1 - e^{-\lambda t}<br>\end{align*}$$</p><p>Then we have the $p.d.f$ of $t$<br>$$\begin{align*}<br>f(t) &#x3D; \frac{d}{dt}P(T \le t)&#x3D; \frac{d}{dt}(1 - e^{-\lambda t} )&#x3D; \lambda e^{-\lambda t}<br>\end{align*}$$</p><p>Then we have<br>$$\begin{align*}<br>&amp;f(t_j|t_{j-1};\lambda)\<br>&amp;&#x3D;\frac{f(t_j,t_{j-1};\lambda)}{f(t_{j-1};\lambda)}\<br>&amp;&#x3D;\frac{f(t_j;\lambda)}{f(t_{j-1};\lambda)}\<br>&amp;&#x3D;\frac{\lambda e^{-\lambda t_j}}{\lambda e^{-\lambda t_{j-1}}}<br>\end{align*}$$<br>an exponential distribution $Exp(t;\lambda)$.</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>Fader, P. S., Hardie, B. G., &amp; Lee, K. L. (2005). “Counting your customers” the easy way: An alternative to the Pareto&#x2F;NBD model. Marketing science, 24(2), 275-284.<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://towardsdatascience.com/poisson-distribution-intuition-and-derivation-1059aeab90d">Poisson Distribution — Intuition, Examples, and Derivation</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://towardsdatascience.com/what-is-exponential-distribution-7bdd08590e2a">Exponential Distribution — Intuition, Derivation, and Applications</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://medium.com/@andrew.chamberlain/deriving-the-poisson-distribution-from-the-binomial-distribution-840cc1668239">Relationship between Poisson Distribution and Binomial Distribution</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.le.ac.uk/users/dsgp1/COURSES/LEISTATS/poisson.pdf">Proof - Limiting form of Binomial distribution</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
    <tags>
      
      <tag>Stat</tag>
      
      <tag>Customer-Based Analysis</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
